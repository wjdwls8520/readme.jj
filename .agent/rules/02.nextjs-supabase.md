---
trigger: always_on
---

# Next.js (App Router) & Supabase Best Practices

## 1. Core Principles
- **Framework**: Use Next.js 14+ with **App Router**. Do not use the `pages` directory.
- **Language**: TypeScript is mandatory. Use strict typing (no `any`).
- **Comments**: **Must write all code comments in Korean (Hangul)** for maintainability.

## 2. Component Architecture
- **Server Components by Default**: All components should be Server Components unless they explicitly require client-side interactivity (hooks, event listeners).
- **Client Components**: Add `'use client'` directive at the very top of the file only when necessary.
- **Data Fetching**: Fetch data directly in Server Components using `async/await`. Avoid `useEffect` for data fetching unless absolutely necessary.

## 3. Supabase Integration
- **Auth & RLS**: Rely on Supabase Auth and Row Level Security (RLS) for security. Do not implement custom auth logic manually.
- **Client Management**: Use `@supabase/ssr` package.
  - Use `createBrowserClient` for Client Components.
  - Use `createServerClient` for Server Components and Server Actions.

## 4. Vercel Optimization
- **Images**: Always use `next/image` component for image optimization.
- **Edge Functions**: Prefer Vercel Edge Functions or Serverless Functions for lightweight backend logic.